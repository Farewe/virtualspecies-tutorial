<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>7. Sampling occurrences</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Virtualspecies tutorial</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Introduction</a>
</li>
<li>
  <a href="01-inputdata.html">1. Input data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Simulating virtual species
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="02-response.html">2. Virtual species defined by response to environmental variables</a>
    </li>
    <li>
      <a href="03-PCA.html">3. Virtual species defined by response to a PCA of the environment</a>
    </li>
    <li>
      <a href="04-presenceabsence.html">4. Converting environmental suitability to presence-absence</a>
    </li>
    <li>
      <a href="05-randomspecies.html">5. Generating random species</a>
    </li>
  </ul>
</li>
<li>
  <a href="06-virtualspeciesobjects.html">6. Exploring virtual species</a>
</li>
<li>
  <a href="07-sampleoccurrences.html">7. Sampling occurrences</a>
</li>
<li>
  <a href="08-dispersallimitation.html">8. Dispersal limitation</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">7. Sampling occurrences</h1>

</div>


<div id="basic-usage" class="section level2">
<h2>7.1. Basic usage</h2>
<p>If you generated virtual species distributions with this package,
there is a good chance that your objective is to test a particular
modelling protocol or technique. Hence, there is one last step for you
to perform: the sampling of species occurrences. This can be done with
the function <code>sampleOccurrences</code>, with which you can sample
either “presence-absence” or “presence only” occurrence data. The
function <code>sampleOccurrences</code> also provides the possibility to
introduce a number of sampling biases, such as uneven spatial sampling
intensity, probability of detection, and probability of error.</p>
<p>Let’s see an example in practice, using the same tropical species we
generated in the beginning of this tutorial:</p>
<pre class="r"><code>library(virtualspecies)</code></pre>
<pre><code>## Le chargement a nécessité le package : terra</code></pre>
<pre><code>## terra 1.7.46</code></pre>
<pre><code>## The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
## which was just loaded, will retire in October 2023.
## Please refer to R-spatial evolution reports for details, especially
## https://r-spatial.org/r/2023/05/15/evolution4.html.
## It may be desirable to make the sf package available;
## package maintainers should consider adding sf to Suggests:.
## The sp package is now running under evolution status 2
##      (status 2 uses the sf package in place of rgdal)</code></pre>
<pre class="r"><code>library(geodata)
# Worldclim data
worldclim &lt;- worldclim_global(var = &quot;bio&quot;, res = 10,
                              path = tempdir())
names(worldclim) &lt;- paste0(&quot;bio&quot;, 1:19)

# Formatting of the response functions
my.parameters &lt;- formatFunctions(bio1 = c(fun = &#39;dnorm&#39;, mean = 25, sd = 5),
                                 bio12 = c(fun = &#39;dnorm&#39;, mean = 4000, sd = 2000))

# Generation of the virtual species
my.first.species &lt;- generateSpFromFun(raster.stack = worldclim[[c(&quot;bio1&quot;, &quot;bio12&quot;)]],
                                      parameters = my.parameters)</code></pre>
<pre><code>## Generating virtual species environmental suitability...</code></pre>
<pre><code>##  - The response to each variable was rescaled between 0 and 1. To
##             disable, set argument rescale.each.response = FALSE</code></pre>
<pre><code>##  - The final environmental suitability was rescaled between 0 and 1. To disable, set argument rescale = FALSE</code></pre>
<pre class="r"><code># Conversion to presence-absence
my.first.species &lt;- convertToPA(my.first.species,
                                beta = 0.7, plot = FALSE)</code></pre>
<pre><code>##    --- Determing species.prevalence automatically according to alpha and beta</code></pre>
<pre><code>##    Logistic conversion finished:
##               
## - beta = 0.7
## - alpha = -0.05
## - species prevalence =0.0244971555083639</code></pre>
<pre class="r"><code># Sampling of &#39;presence only&#39; occurrences
presence.points &lt;- sampleOccurrences(my.first.species,
                                     n = 30, # The number of points to sample
                                     type = &quot;presence only&quot;)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp1b-1.png"
alt="Fig 7.1 Illustration of the points sampled for our virtual species" />
<div class="figcaption">Fig 7.1 Illustration of the points sampled for
our virtual species</div>
</div>
<p>We can see that a map was plotted, with the sampled presence points
illustrated with black dots.</p>
<p>Now let’s see how our object <code>presence.points</code> looks
like:</p>
<pre class="r"><code>presence.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence only
## - Number of points: 30
## - No sampling bias
## - Detection probability: 
##    .Probability: 1
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                  x         y Real Observed
## 1088748 -162.08333  5.916667    1        1
## 1237397  132.75000 -5.416667    1        1
## 1231880  -66.75000 -5.083333    1        1
## 1121785  -55.91667  3.416667    1        1
## 1169344  -49.41667 -0.250000    1        1
## 1215812  135.25000 -3.750000    1        1
## 1263173  108.75000 -7.416667    1        1
## 939106    97.58333 17.583333    1        1
## 1266396  -74.08333 -7.750000    1        1
## 1256676  105.91667 -6.916667    1        1
## ... 20 more lines.</code></pre>
<p>This message summarizes us information about the 30 occurrence points
we just sampled. Now let’s look at the structure of this object:</p>
<pre class="r"><code>str(presence.points)</code></pre>
<pre><code>## List of 8
##  $ type                        : chr &quot;presence only&quot;
##  $ detection.probability       :List of 2
##   ..$ detection.probability : num 1
##   ..$ correct.by.suitability: logi FALSE
##  $ error.probability           : num 0
##  $ bias                        : NULL
##  $ replacement                 : logi FALSE
##  $ original.distribution.raster:S4 class &#39;SpatRaster&#39; [package &quot;terra&quot;]
##  $ sample.plot                 :List of 3
##   ..$ :Dotted pair list of 24
##   ..$ : raw [1:35992] 00 00 00 00 ...
##   .. ..- attr(*, &quot;pkgName&quot;)= chr &quot;graphics&quot;
##   ..$ :List of 2
##   .. ..- attr(*, &quot;pkgName&quot;)= chr &quot;grid&quot;
##   ..- attr(*, &quot;engineVersion&quot;)= int 16
##   ..- attr(*, &quot;pid&quot;)= int 31592
##   ..- attr(*, &quot;Rversion&quot;)=Classes &#39;R_system_version&#39;, &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   ..- attr(*, &quot;load&quot;)= chr(0) 
##   ..- attr(*, &quot;attach&quot;)= chr(0) 
##   ..- attr(*, &quot;class&quot;)= chr &quot;recordedplot&quot;
##  $ sample.points               :&#39;data.frame&#39;:    30 obs. of  4 variables:
##   ..$ x       : num [1:30] -162.1 132.8 -66.8 -55.9 -49.4 ...
##   ..$ y       : num [1:30] 5.92 -5.42 -5.08 3.42 -0.25 ...
##   ..$ Real    : num [1:30] 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ Observed: num [1:30] 1 1 1 1 1 1 1 1 1 1 ...
##  - attr(*, &quot;RNGkind&quot;)= chr [1:3] &quot;Mersenne-Twister&quot; &quot;Inversion&quot; &quot;Rejection&quot;
##  - attr(*, &quot;seed&quot;)= int [1:626] 10403 288 -962552501 -84035233 1038343804 1488043481 889822882 1185920310 -301917002 -1257285662 ...
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;VSSampledPoints&quot; &quot;list&quot;</code></pre>
<p>This is a list containing eight elements:</p>
<ol style="list-style-type: decimal">
<li><code>type</code>: the type of occurrence sampled (presence absence
or presence-only)</li>
<li><code>detection.probability</code>: the detection probability of our
virtual species</li>
<li><code>error.probability</code>: the probability of an erroneous
detection of our virtual species</li>
<li><code>bias</code>: if you introduced a sampling bias, this part will
contain the appropriate info</li>
<li><code>replacement</code>: a logical indicating if you allowed
multiple samples in the same cells</li>
<li><code>original.distribution.raster</code>: the raster from which
occurrences were sampled</li>
<li><code>sample.plot</code>: contains the graphical representation of
your samples, so it can be called later</li>
<li><code>sampled.points</code>: a data frame containing the sampled
points</li>
</ol>
<p>It also says to us that there are several attributes stored, such as
the information about the randomisation process (<code>RNGkind</code>
and <code>seed</code>). You can use these attributes later to reproduce
exactly a previous sampling.</p>
<p>Now, we can specifically access the data frame of sampled points:</p>
<pre class="r"><code>presence.points$sample.points</code></pre>
<pre><code>##                  x          y Real Observed
## 1088748 -162.08333  5.9166667    1        1
## 1237397  132.75000 -5.4166667    1        1
## 1231880  -66.75000 -5.0833333    1        1
## 1121785  -55.91667  3.4166667    1        1
## 1169344  -49.41667 -0.2500000    1        1
## 1215812  135.25000 -3.7500000    1        1
## 1263173  108.75000 -7.4166667    1        1
## 939106    97.58333 17.5833333    1        1
## 1266396  -74.08333 -7.7500000    1        1
## 1256676  105.91667 -6.9166667    1        1
## 1036344  103.91667 10.0833333    1        1
## 1079403   80.41667  6.7500000    1        1
## 1123891  -64.91667  3.2500000    1        1
## 1274263  157.08333 -8.2500000    1        1
## 1128276  -54.08333  2.9166667    1        1
## 1008091   75.08333 12.2500000    1        1
## 1190806  -72.41667 -1.9166667    1        1
## 1227526  -72.41667 -4.7500000    1        1
## 1185573  135.41667 -1.4166667    1        1
## 1194022  103.58333 -2.0833333    1        1
## 1017015  122.41667 11.5833333    1        1
## 1106601  -66.58333  4.5833333    1        1
## 967236   105.91667 15.4166667    1        1
## 993113    98.75000 13.4166667    1        1
## 1198388  111.25000 -2.4166667    1        1
## 1107692  115.25000  4.5833333    1        1
## 1150857  109.41667  1.2500000    1        1
## 1154207  -52.25000  0.9166667    1        1
## 962853    95.41667 15.7500000    1        1
## 1023515  125.75000 11.0833333    1        1</code></pre>
<p>The data frame has four colums: the pixel coordinates <code>x</code>
and <code>y</code>, the real presence/absence (1/0) of the species in
the sampled pixel <code>Real</code>, and the result of the sampling
<code>Observed</code> (1 = presence, 0 = absence, NA = no information).
The columns <code>Real</code> and <code>Observed</code> differ only if
you have specified a detection probability and/or an error
probability.</p>
<p>Now, let’s sample the other type of occurrence data:
presence-absence.</p>
<pre class="r"><code># Sampling of &#39;presence-absence&#39; occurrences
PA.points &lt;- sampleOccurrences(my.first.species,
                               n = 300,
                               type = &quot;presence-absence&quot;)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp4-1.png"
alt="Fig 7.2 Illustration of the presence-absence points sampled for our virtual species. Black dots are presences, open dots are absences." />
<div class="figcaption">Fig 7.2 Illustration of the presence-absence
points sampled for our virtual species. Black dots are presences, open
dots are absences.</div>
</div>
<pre class="r"><code>PA.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence-absence
## - Number of points: 300
## - No sampling bias
## - Detection probability: 
##    .Probability: 1
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0
## - Sample prevalence: 
##    .True:0.01
##    .Observed:0.01
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                  x         y Real Observed
## 171413   -51.25000  76.75000    0        0
## 479386   157.58333  53.08333    0        0
## 791057   -97.25000  28.91667    0        0
## 2298665 -109.25000 -87.41667    0        0
## 2083546   37.58333 -70.75000    0        0
## 599737    56.08333  43.75000    0        0
## 2043008  121.25000 -67.58333    0        0
## 712122    66.91667  35.08333    0        0
## 773755  -100.91667  30.25000    0        0
## 554845   134.08333  47.25000    0        0
## ... 290 more lines.</code></pre>
<p>You can see that the points are sampled randomly throughout the whole
raster. However, we may have only a few or even no presence points at
all because the samples are purely random at the moment. We can define
the number of presences and the number of absences by using the
parameter <a
href="#defining-the-sample-prevalence"><code>sample.prevalence</code></a>.</p>
<p>You may be interested in extracting the true probability of
occurrence at each sampled point, to compare with your SDM results. To
do this, use argument <code>extract.probability</code>:</p>
<pre class="r"><code># Sampling of &#39;presence-absence&#39; occurrences
PA.points &lt;- sampleOccurrences(my.first.species,
                               n = 30,
                               type = &quot;presence-absence&quot;,
                               extract.probability = TRUE,
                               plot = FALSE)
PA.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence-absence
## - Number of points: 30
## - No sampling bias
## - Detection probability: 
##    .Probability: 1
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0
## - Sample prevalence: 
##    .True:0
##    .Observed:0
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                  x          y Real Observed true.probability
## 670998    52.91667  38.250000    0        0     1.658934e-06
## 894718  -100.41667  20.916667    0        0     2.151494e-06
## 2146264   50.58333 -75.583333    0        0     8.315280e-07
## 1272000  139.91667  -8.083333    0        0     9.830516e-03
## 2149559 -120.25000 -75.916667    0        0     8.315280e-07
## 274191   158.41667  68.916667    0        0     8.315280e-07
## 2286879   86.41667 -86.416667    0        0     8.315280e-07
## 558885    87.41667  46.916667    0        0     8.333703e-07
## 730586   -95.75000  33.583333    0        0     6.658379e-06
## 2088575  155.75000 -71.083333    0        0     8.315280e-07
## ... 20 more lines.</code></pre>
<p>In the next section you will see how to limit the sampling to a
region in particular, and after that, how to introduce a bias in the
sampling procedure.</p>
</div>
<div id="delimiting-a-sampling-area" class="section level2">
<h2>7.2. Delimiting a sampling area</h2>
<p>There are three main possibilities to delimit the sampling areas
:</p>
<ol style="list-style-type: decimal">
<li>Specifying the region(s) of the world (country, continent,
region</li>
<li>Provide a polygon (of type <code>SpatialPolygons</code> or
<code>SpatialPolygonsDataFrame</code> of package <code>sp</code>)</li>
<li>Provide an <code>extent</code> object (a rectangular area, from the
package <code>raster</code>)</li>
</ol>
<div id="specifying-the-regions-of-the-world" class="section level3">
<h3>7.2.1. Specifying the region(s) of the world</h3>
<p>You can specify any combination of countries, continents and regions
of the world to restrict your sampling area, using the argument
<code>sampling.area</code>. For example:</p>
<pre class="r"><code># Sampling of &#39;presence-absence&#39; occurrences
PA.points &lt;- sampleOccurrences(my.first.species,
                               n = 30,
                               type = &quot;presence-absence&quot;,
                               sampling.area = c(&quot;South America&quot;, &quot;Mexico&quot;))</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp5-1.png"
alt="Fig 7.3 Illustration of points sampled in a restricted area (here, South America + Mexico)" />
<div class="figcaption">Fig 7.3 Illustration of points sampled in a
restricted area (here, South America + Mexico)</div>
</div>
<p>The only restriction is to provide the correct names and to have the
package <code>rnaturalearth</code> installed.</p>
<p>The correct region names are: “Africa”, “Antarctica”, “Asia”,
“Oceania”, “Europe”, “Americas”</p>
<p>The correct continent names are: “Africa”, “Antarctica”, “Asia”,
“Europe”, “North America”, “Oceania”, “South America”</p>
<p>And you can consult the correct names with the following
commands:</p>
<pre class="r"><code># Country names
 unique(rnaturalearth::ne_countries(returnclass =&#39;sf&#39;)$sovereignt)</code></pre>
<pre><code>##   [1] &quot;Fiji&quot;                             &quot;United Republic of Tanzania&quot;     
##   [3] &quot;Western Sahara&quot;                   &quot;Canada&quot;                          
##   [5] &quot;United States of America&quot;         &quot;Kazakhstan&quot;                      
##   [7] &quot;Uzbekistan&quot;                       &quot;Papua New Guinea&quot;                
##   [9] &quot;Indonesia&quot;                        &quot;Argentina&quot;                       
##  [11] &quot;Chile&quot;                            &quot;Democratic Republic of the Congo&quot;
##  [13] &quot;Somalia&quot;                          &quot;Kenya&quot;                           
##  [15] &quot;Sudan&quot;                            &quot;Chad&quot;                            
##  [17] &quot;Haiti&quot;                            &quot;Dominican Republic&quot;              
##  [19] &quot;Russia&quot;                           &quot;The Bahamas&quot;                     
##  [21] &quot;United Kingdom&quot;                   &quot;Norway&quot;                          
##  [23] &quot;Denmark&quot;                          &quot;France&quot;                          
##  [25] &quot;East Timor&quot;                       &quot;South Africa&quot;                    
##  [27] &quot;Lesotho&quot;                          &quot;Mexico&quot;                          
##  [29] &quot;Uruguay&quot;                          &quot;Brazil&quot;                          
##  [31] &quot;Bolivia&quot;                          &quot;Peru&quot;                            
##  [33] &quot;Colombia&quot;                         &quot;Panama&quot;                          
##  [35] &quot;Costa Rica&quot;                       &quot;Nicaragua&quot;                       
##  [37] &quot;Honduras&quot;                         &quot;El Salvador&quot;                     
##  [39] &quot;Guatemala&quot;                        &quot;Belize&quot;                          
##  [41] &quot;Venezuela&quot;                        &quot;Guyana&quot;                          
##  [43] &quot;Suriname&quot;                         &quot;Ecuador&quot;                         
##  [45] &quot;Jamaica&quot;                          &quot;Cuba&quot;                            
##  [47] &quot;Zimbabwe&quot;                         &quot;Botswana&quot;                        
##  [49] &quot;Namibia&quot;                          &quot;Senegal&quot;                         
##  [51] &quot;Mali&quot;                             &quot;Mauritania&quot;                      
##  [53] &quot;Benin&quot;                            &quot;Niger&quot;                           
##  [55] &quot;Nigeria&quot;                          &quot;Cameroon&quot;                        
##  [57] &quot;Togo&quot;                             &quot;Ghana&quot;                           
##  [59] &quot;Ivory Coast&quot;                      &quot;Guinea&quot;                          
##  [61] &quot;Guinea-Bissau&quot;                    &quot;Liberia&quot;                         
##  [63] &quot;Sierra Leone&quot;                     &quot;Burkina Faso&quot;                    
##  [65] &quot;Central African Republic&quot;         &quot;Republic of the Congo&quot;           
##  [67] &quot;Gabon&quot;                            &quot;Equatorial Guinea&quot;               
##  [69] &quot;Zambia&quot;                           &quot;Malawi&quot;                          
##  [71] &quot;Mozambique&quot;                       &quot;eSwatini&quot;                        
##  [73] &quot;Angola&quot;                           &quot;Burundi&quot;                         
##  [75] &quot;Israel&quot;                           &quot;Lebanon&quot;                         
##  [77] &quot;Madagascar&quot;                       &quot;Gambia&quot;                          
##  [79] &quot;Tunisia&quot;                          &quot;Algeria&quot;                         
##  [81] &quot;Jordan&quot;                           &quot;United Arab Emirates&quot;            
##  [83] &quot;Qatar&quot;                            &quot;Kuwait&quot;                          
##  [85] &quot;Iraq&quot;                             &quot;Oman&quot;                            
##  [87] &quot;Vanuatu&quot;                          &quot;Cambodia&quot;                        
##  [89] &quot;Thailand&quot;                         &quot;Laos&quot;                            
##  [91] &quot;Myanmar&quot;                          &quot;Vietnam&quot;                         
##  [93] &quot;North Korea&quot;                      &quot;South Korea&quot;                     
##  [95] &quot;Mongolia&quot;                         &quot;India&quot;                           
##  [97] &quot;Bangladesh&quot;                       &quot;Bhutan&quot;                          
##  [99] &quot;Nepal&quot;                            &quot;Pakistan&quot;                        
## [101] &quot;Afghanistan&quot;                      &quot;Tajikistan&quot;                      
## [103] &quot;Kyrgyzstan&quot;                       &quot;Turkmenistan&quot;                    
## [105] &quot;Iran&quot;                             &quot;Syria&quot;                           
## [107] &quot;Armenia&quot;                          &quot;Sweden&quot;                          
## [109] &quot;Belarus&quot;                          &quot;Ukraine&quot;                         
## [111] &quot;Poland&quot;                           &quot;Austria&quot;                         
## [113] &quot;Hungary&quot;                          &quot;Moldova&quot;                         
## [115] &quot;Romania&quot;                          &quot;Lithuania&quot;                       
## [117] &quot;Latvia&quot;                           &quot;Estonia&quot;                         
## [119] &quot;Germany&quot;                          &quot;Bulgaria&quot;                        
## [121] &quot;Greece&quot;                           &quot;Turkey&quot;                          
## [123] &quot;Albania&quot;                          &quot;Croatia&quot;                         
## [125] &quot;Switzerland&quot;                      &quot;Luxembourg&quot;                      
## [127] &quot;Belgium&quot;                          &quot;Netherlands&quot;                     
## [129] &quot;Portugal&quot;                         &quot;Spain&quot;                           
## [131] &quot;Ireland&quot;                          &quot;Solomon Islands&quot;                 
## [133] &quot;New Zealand&quot;                      &quot;Australia&quot;                       
## [135] &quot;Sri Lanka&quot;                        &quot;China&quot;                           
## [137] &quot;Taiwan&quot;                           &quot;Italy&quot;                           
## [139] &quot;Iceland&quot;                          &quot;Azerbaijan&quot;                      
## [141] &quot;Georgia&quot;                          &quot;Philippines&quot;                     
## [143] &quot;Malaysia&quot;                         &quot;Brunei&quot;                          
## [145] &quot;Slovenia&quot;                         &quot;Finland&quot;                         
## [147] &quot;Slovakia&quot;                         &quot;Czechia&quot;                         
## [149] &quot;Eritrea&quot;                          &quot;Japan&quot;                           
## [151] &quot;Paraguay&quot;                         &quot;Yemen&quot;                           
## [153] &quot;Saudi Arabia&quot;                     &quot;Antarctica&quot;                      
## [155] &quot;Northern Cyprus&quot;                  &quot;Cyprus&quot;                          
## [157] &quot;Morocco&quot;                          &quot;Egypt&quot;                           
## [159] &quot;Libya&quot;                            &quot;Ethiopia&quot;                        
## [161] &quot;Djibouti&quot;                         &quot;Somaliland&quot;                      
## [163] &quot;Uganda&quot;                           &quot;Rwanda&quot;                          
## [165] &quot;Bosnia and Herzegovina&quot;           &quot;North Macedonia&quot;                 
## [167] &quot;Republic of Serbia&quot;               &quot;Montenegro&quot;                      
## [169] &quot;Kosovo&quot;                           &quot;Trinidad and Tobago&quot;             
## [171] &quot;South Sudan&quot;</code></pre>
</div>
<div id="providing-a-polygon" class="section level3">
<h3>7.2.2. Providing a polygon</h3>
<p>In this case you have to import in R your own polygon, using commands
of packages <code>sf</code> or <code>terra</code>.</p>
<p>We will use here an example of a <code>terra</code> object which we
can downloaded straight into R using the R package <code>geodata</code>.
Since our species is a tropical species, let’s assume we are working in
Brazil only. Remember that this is an example, and that you can import
your own polygons into R.</p>
<p>First, let’s download our polygon:</p>
<pre class="r"><code>brazil &lt;- gadm(country = &quot;BRA&quot;, level = 0, path = tempdir())</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp7-1.png"
alt="Fig 7.4 A polygon of the brazil" />
<div class="figcaption">Fig 7.4 A polygon of the brazil</div>
</div>
<p>Now, to limit the sampling area to our polygon, we simply provide it
to the argument <code>sampling.area</code> of the function
<code>sampleOccurrences()</code>:</p>
<pre class="r"><code>PA.points &lt;- sampleOccurrences(my.first.species,
                               n = 30,
                               type = &quot;presence-absence&quot;,
                               sampling.area = brazil)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp8-1.png"
alt="Fig 7.5 Points sampled within the Brazil polygon" />
<div class="figcaption">Fig 7.5 Points sampled within the Brazil
polygon</div>
</div>
<pre class="r"><code>PA.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence-absence
## - Number of points: 30
## - No sampling bias
## - Detection probability: 
##    .Probability: 1
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0
## - Sample prevalence: 
##    .True:0.133333333333333
##    .Observed:0.133333333333333
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                 x           y Real Observed
## 1432910 -41.75000 -20.5833333    0        0
## 1456600 -53.41667 -22.4166667    0        0
## 1435026 -49.08333 -20.7500000    0        0
## 1242853 -37.91667  -5.9166667    0        0
## 1221202 -46.41667  -4.2500000    0        0
## 1346456 -50.75000 -13.9166667    0        0
## 1149845 -59.25000   1.2500000    1        1
## 1277399 -40.25000  -8.5833333    0        0
## 1160682 -53.08333   0.4166667    0        0
## 1203856 -57.41667  -2.9166667    1        1
## ... 20 more lines.</code></pre>
<p>It worked!</p>
<p>However, the plot is not very convenient because it kept the scale of
our input raster, so we may be interested in manually restricting the
plot region to Brasil:</p>
<pre class="r"><code># First we get our data frame of occurrence points
occ &lt;- PA.points$sample.points

plot(my.first.species$pa.raster, 
     xlim = c(-80, -30),
     ylim = c(-35, 10))
plot(brazil, add = TRUE)
points(occ[occ$Observed == 1, c(&quot;x&quot;, &quot;y&quot;)], pch = 16, cex = .8)
points(occ[occ$Observed == 0, c(&quot;x&quot;, &quot;y&quot;)], pch = 1, cex = .8)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp9-1.png"
alt="Fig 7.6 Points sampled within the Brazil polygon, with a suitable zoom" />
<div class="figcaption">Fig 7.6 Points sampled within the Brazil
polygon, with a suitable zoom</div>
</div>
</div>
<div id="providing-an-extent-object" class="section level3">
<h3>7.2.3. Providing an extent object</h3>
<p>An extent object is a rectangular area defined by four coordinates
xmin/xmax/ymin/ymax. You can easily create an extent object using the
command <code>extent</code>, of the package <code>raster</code>:</p>
<pre class="r"><code>my.extent &lt;- ext(-80, -30, -35, 10)
PA.points &lt;- sampleOccurrences(my.first.species,
                               n = 30,
                               type = &quot;presence-absence&quot;,
                               sampling.area = my.extent)
plot(my.extent, add = TRUE)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp10-1.png"
alt="Fig 7.7 Points sampled within our extent object" />
<div class="figcaption">Fig 7.7 Points sampled within our extent
object</div>
</div>
</div>
<div id="draw-an-extent-or-a-polygon-to-sample" class="section level3">
<h3>7.2.4 Draw an extent or a polygon to sample</h3>
<p>You can draw a polygon manually with <code>terra</code> and feed it
to <code>sampleOccurrences</code>, try it yourself (press ‘escape’ when
finished):</p>
<pre class="r"><code>plot(my.first.species$pa.raster)
my.polygon &lt;- terra::draw(x = &quot;polygon&quot;)</code></pre>
</div>
</div>
<div id="introducing-a-sampling-bias" class="section level2">
<h2>7.3. Introducing a sampling bias</h2>
<div id="detection-probability" class="section level3">
<h3>7.3.1.Detection probability</h3>
<p>Detection probability has been shown to be influential on SDM
performance. Hence, you might be interested in generating species with
varying degrees of detection probability. This can be done easily, using
the argument <code>detection.probability</code>, ranging from 0 (species
cannot be detected) to 1 (species is always detected):</p>
<pre class="r"><code># Let&#39;s try to find samples of a very cryptic species
PA.points &lt;- sampleOccurrences(my.first.species,
                               sampling.area = &quot;Brazil&quot;,
                               n = 50,
                               type = &quot;presence-absence&quot;,
                               detection.probability = 0.3)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp11-1.png"
alt="Fig 7.8 Presence-absence points sampled with a low detection probability" />
<div class="figcaption">Fig 7.8 Presence-absence points sampled with a
low detection probability</div>
</div>
<pre class="r"><code>PA.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence-absence
## - Number of points: 50
## - No sampling bias
## - Detection probability: 
##    .Probability: 0.3
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0
## - Sample prevalence: 
##    .True:0.12
##    .Observed:0.02
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                 x           y Real Observed
## 1326981 -56.58333 -12.4166667    1        0
## 1309652 -64.75000 -11.0833333    0        0
## 1156359 -53.58333   0.7500000    0        0
## 1171444 -59.41667  -0.4166667    0        0
## 1247144 -42.75000  -6.2500000    0        0
## 1184414 -57.75000  -1.4166667    1        1
## 1139030 -61.75000   2.0833333    0        0
## 1290259 -56.91667  -9.5833333    0        0
## 1327085 -39.25000 -12.4166667    0        0
## 1374598 -40.41667 -16.0833333    0        0
## ... 40 more lines.</code></pre>
<p>You can see that some points sampled in its distribution range are
classified as “absences”.</p>
<p>If you use this argument when sampling ‘presence only’ occurrences,
then this will result in a lower number of sampled points than
asked:</p>
<pre class="r"><code>PO.points &lt;- sampleOccurrences(my.first.species,
                               sampling.area = &quot;Brazil&quot;,
                               n = 50,
                               type = &quot;presence only&quot;,
                               detection.probability = 0.3)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp12-1.png"
alt="Fig 7.9 Presence only points sampled with a low detection probability" />
<div class="figcaption">Fig 7.9 Presence only points sampled with a low
detection probability</div>
</div>
<pre class="r"><code>PO.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence only
## - Number of points: 50
## - No sampling bias
## - Detection probability: 
##    .Probability: 0.3
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                 x         y Real Observed
## 1247014 -64.41667 -6.250000    1       NA
## 1257867 -55.58333 -7.083333    1       NA
## 1218920 -66.75000 -4.083333    1        1
## 1184404 -59.41667 -1.416667    1       NA
## 1186618 -50.41667 -1.583333    1        1
## 1227529 -71.91667 -4.750000    1       NA
## 1186570 -58.41667 -1.583333    1       NA
## 1253482 -66.41667 -6.750000    1       NA
## 1156296 -64.08333  0.750000    1        1
## 1236182 -69.75000 -5.416667    1       NA
## ... 40 more lines.</code></pre>
<p>In this case, we see that out of all the possible sampling points,
only a fraction are sampled as presence points.</p>
</div>
<div
id="detection-probability-as-a-function-of-environmental-suitability"
class="section level3">
<h3>7.3.2. Detection probability as a function of environmental
suitability</h3>
<p>You can further complexify the detection probability by making it
dependent on the environmental suitability. In this case, cells will be
weighted by the environmental suitability: less suitable cells will have
a lesser chance of detecting the species. This can be seen as an impact
on the population size: a higher environmental suitability increases the
population size, and thus the detection probability. How does this work
in practice?</p>
<p>The initial probability of detection (<span
class="math inline">\(P_{di}\)</span>) is multiplied by the
environmental suitability (<span class="math inline">\(S\)</span>) to
obtain the final probability of detection (<span
class="math inline">\(P_d\)</span>):</p>
<p><span class="math display">\[P_d = P_{di} \times S\]</span></p>
<p>Hence, if our species has a probability of detection of 0.5, the
final probability of detection will be:</p>
<ul>
<li>0.5 if the cell has an environmental suitability of 1</li>
<li>0.25 if the cell has an environmental suitability of 0.5</li>
</ul>
<p>Of course, no occurrence points will be detected outside the
distribution range, regardless of their environmental suitability.</p>
<p>You can also keep the detection probability to 1, and set
<code>correct.by.suitability = TRUE</code>. In that case, the detection
probability will be equal to the environmental suitability. This can be
seen as a species whose detection probability is strictly dependent on
its population size, which in turn is strictly dependent on the
environmental suitability.</p>
<p>An example in practice:</p>
<pre class="r"><code>PA.points &lt;- sampleOccurrences(my.first.species,
                               sampling.area = &quot;Brazil&quot;,
                               n = 100,
                               type = &quot;presence-absence&quot;,
                               detection.probability = 1,
                               correct.by.suitability = TRUE,
                               plot = FALSE)

# Below is a custom plot to show the sampled point above the map of environmental suitability
occ &lt;- PA.points$sample.points

plot(my.first.species$suitab.raster, 
     xlim = c(-80, -20),
     ylim = c(-35, 5))
# plot(brasil, add = TRUE)
points(occ[occ$Observed == 1, c(&quot;x&quot;, &quot;y&quot;)], pch = 16, cex = .8)
points(occ[occ$Observed == 0, c(&quot;x&quot;, &quot;y&quot;)], pch = 1, cex = .8)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp13-1.png"
alt="Fig 7.10 Presence-absence points sampled with a detection probability equal to the environmental suitability" />
<div class="figcaption">Fig 7.10 Presence-absence points sampled with a
detection probability equal to the environmental suitability</div>
</div>
</div>
<div id="error-probability" class="section level3">
<h3>7.3.3. Error probability</h3>
<p>You can also introduce an error probability, which is a probability
of finding the species where it is absent. This is straightforward with
the argument <code>error.probability</code>:</p>
<pre class="r"><code>PA.points &lt;- sampleOccurrences(my.first.species,
                               sampling.area = &quot;Brazil&quot;,
                               n = 20,
                               type = &quot;presence-absence&quot;,
                               error.probability = 0.3)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp14-1.png"
alt="Fig 7.11 Presence-absence points sampled with an error probability of 0.3" />
<div class="figcaption">Fig 7.11 Presence-absence points sampled with an
error probability of 0.3</div>
</div>
<pre class="r"><code>PA.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence-absence
## - Number of points: 20
## - No sampling bias
## - Detection probability: 
##    .Probability: 1
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0.3
## - Sample prevalence: 
##    .True:0.3
##    .Observed:0.65
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                 x          y Real Observed
## 1147727 -52.25000   1.416667    1        1
## 1188797 -47.25000  -1.750000    1        1
## 1560265 -55.91667 -30.416667    0        0
## 1350831 -41.58333 -14.250000    0        1
## 1303221 -56.58333 -10.583333    0        1
## 1197415 -50.91667  -2.416667    1        1
## 1394019 -43.58333 -17.583333    0        0
## 1290282 -53.08333  -9.583333    1        1
## 1413416 -50.75000 -19.083333    0        1
## 1396147 -48.91667 -17.750000    0        0
## ... 10 more lines.</code></pre>
<p>One important remark with the error probability:</p>
<p><strong>There is an interaction between the detection probability and
the error probability</strong>: in a cell where the species is present,
but not detected, a presence can still be attributed because of an
error. See the following (extreme) example, for a species with a low
detection probability and high error probability:</p>
<pre class="r"><code>PA.points &lt;- sampleOccurrences(my.first.species,
                               sampling.area = &quot;Brazil&quot;,
                               n = 20,
                               type = &quot;presence-absence&quot;,
                               detection.probability = 0.2,
                               error.probability = 0.8)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp15-1.png"
alt="Fig 7.12 Presence-absence points sampled with a detection probability of 0.2, and an error probability of 0.8. In numerous pixels the species was not detected, but erroneous presences were nevertheless attributed." />
<div class="figcaption">Fig 7.12 Presence-absence points sampled with a
detection probability of 0.2, and an error probability of 0.8. In
numerous pixels the species was not detected, but erroneous presences
were nevertheless attributed.</div>
</div>
<pre class="r"><code>PA.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence-absence
## - Number of points: 20
## - No sampling bias
## - Detection probability: 
##    .Probability: 0.2
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0.8
## - Sample prevalence: 
##    .True:0.15
##    .Observed:0.9
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                 x          y Real Observed
## 1378884 -46.08333 -16.416667    0        1
## 1234154 -47.75000  -5.250000    0        1
## 1383218 -43.75000 -16.750000    0        1
## 1234201 -39.91667  -5.250000    0        1
## 1305484 -39.41667 -10.750000    0        1
## 1156333 -57.91667   0.750000    0        0
## 1212569 -45.25000  -3.583333    0        1
## 1320571 -44.91667 -11.916667    0        1
## 1314075 -47.58333 -11.416667    0        1
## 1385367 -45.58333 -16.916667    0        1
## ... 10 more lines.</code></pre>
</div>
<div id="uneven-sampling-intensity" class="section level3">
<h3>7.3.4. Uneven sampling intensity</h3>
<p>The <code>sampleOccurrences</code> also allows you to introduce a
sampling bias such as uneven sampling intensity in space. How does it
works?</p>
<p>You will have to define a region in which the sampling is biased,
with arguments <code>bias</code> and <code>area</code>. In this region,
the sampling will be biased by a strength equal to the argument
<code>bias.strength</code>. If <code>bias.strength</code> is equal to 50
for example, then the sampling will be 50 times more intense in the
chosen area. If <code>bias.strength</code>is below 1, then the sampling
will be less intense in the biased area than elsewhere.</p>
<p>Let’s see an example in practice before we go into the details:</p>
<pre class="r"><code>PO.points &lt;- sampleOccurrences(my.first.species,
                               n = 100, 
                               bias = &quot;continent&quot;,
                               bias.strength = 20,
                               bias.area = &quot;South America&quot;)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp16-1.png"
alt="Fig 7.13 Presence only points sampled with a strong bias in South America (20 times more sample)" />
<div class="figcaption">Fig 7.13 Presence only points sampled with a
strong bias in South America (20 times more sample)</div>
</div>
<p>Now that you have grasped how the bias works, let’s see the different
possibilities:</p>
<ul>
<li>Introducing a bias using country, region or continent names<br />
Set either <code>bias = "country"</code>, <code>bias = "region"</code>
or <code>bias = "continent"</code>, and provide to
<code>bias.area</code> the name(s) of the country(-ies), region(s) or
continent(s).</li>
</ul>
<pre class="r"><code>PO.points &lt;- sampleOccurrences(my.first.species,
                               n = 100, 
                               bias = &quot;country&quot;,
                               bias.strength = 20,
                               bias.area = c(&quot;Mexico&quot;, &quot;Colombia&quot;))</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp17-1.png"
alt="Fig 7.14 Presence only points sampled with a strong bias in Mexico and Colombia" />
<div class="figcaption">Fig 7.14 Presence only points sampled with a
strong bias in Mexico and Colombia</div>
</div>
<ul>
<li>Using a polygon in which the sampling will be biased<br />
Set <code>bias = "polygon"</code>, and provide a polygon
(<code>sf</code> or <code>terra</code> object, classes <code>sf</code>
or <code>SpatVector</code>) to the argument <code>bias.area</code>.</li>
</ul>
<pre class="r"><code>philippines &lt;- rnaturalearth::ne_countries(country = &quot;Philippines&quot;,
                                           returnclass = &quot;sf&quot;)
PO.points &lt;- sampleOccurrences(my.first.species,
                               n = 100, 
                               bias = &quot;polygon&quot;,
                               bias.strength = 50,
                               bias.area = philippines)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp18-1.png"
alt="Fig 7.15 Presence only points sampled with strong bias for the Philippines, using a polygon" />
<div class="figcaption">Fig 7.15 Presence only points sampled with
strong bias for the Philippines, using a polygon</div>
</div>
<ul>
<li>Using an extent object<br />
Set <code>bias = "extent"</code>, and provide an extent to the argument
<code>bias.area</code> (<a href="#providing-an-extent-object">see
section 7.2.3. if you are not familiar with extents</a>). You can also
simply set <code>bias = "polygon"</code> (<em>new in version 1.6</em>)
or <code>bias = "extent"</code>, and click on the map when asked
to:</li>
</ul>
<pre class="r"><code>PO.points &lt;- sampleOccurrences(my.first.species,
                               n = 100, 
                               bias = &quot;polygon&quot;, # also works with &quot;extent&quot;
                               bias.strength = 50)</code></pre>
<ul>
<li>Manually defining weights for all the cells<br />
A last option is to manually define the weights with which the sampling
will be biased. This may be especially useful when you want to precisely
create a sampling bias. To do this, set <code>bias = "manual"</code>,
and provide a raster of weights to the argument
<code>weights</code>.<br />
To clear things up, we will see an example together:</li>
</ul>
<pre class="r"><code># First, we create a raster of weights
# As an arbitrary example, we will use the area of each cell as a weight:
# larger cells have more chance of being sampled
weight.raster &lt;- cellSize(worldclim)

plot(weight.raster)
# Add continents
plot(rnaturalearth::ne_coastline(returnclass = &quot;sf&quot;)[1], add = TRUE)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp20-1.png"
alt="Fig 7.16 Raster used to weight the sampling bias: a raster of cell areas" />
<div class="figcaption">Fig 7.16 Raster used to weight the sampling
bias: a raster of cell areas</div>
</div>
<p>Now, let’s weight our samples using this raster:</p>
<pre class="r"><code>PO.points &lt;- sampleOccurrences(my.first.species,
                               n = 100, 
                               bias = &quot;manual&quot;,
                               weights = weight.raster)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp21-1.png"
alt="Fig 7.17 Presence only points sampled with a sampling biased according to the area of each cell" />
<div class="figcaption">Fig 7.17 Presence only points sampled with a
sampling biased according to the area of each cell</div>
</div>
<p>Of course, the changes are not visible, because our species occurs
mainly in pixels of relatively similar areas. Nevertheless, this example
should be useful if you want to create a manual sampling bias later
on.</p>
</div>
<div id="sampling-multiple-records-in-the-same-cells"
class="section level3">
<h3>7.3.5. Sampling multiple records in the same cells</h3>
<p>In real datasets such as Museum datasets, it is frequent to have
multiple records in the same cells. To mimic such datasets, it is
possible to allow the function to sample repeatedly in the same
cells:</p>
<pre class="r"><code>PO.points &lt;- sampleOccurrences(my.first.species,
                               n = 1000, 
                               replacement = TRUE,
                               plot = FALSE)

# Number of duplicated records: 
length(which(duplicated(PO.points$sample.points[, c(&quot;x&quot;, &quot;y&quot;)])))</code></pre>
<pre><code>## [1] 20</code></pre>
</div>
</div>
<div id="defining-the-sample-prevalence" class="section level2">
<h2>7.4. Defining the sample prevalence</h2>
<p><em>The sample prevalence is the proportion of samples in which the
species has been found. It is therefore different from the species
prevalence which <a
href="04-presenceabsence.html#conversion-to-presence-absence-based-on-a-value-of-species-prevalence">was
mentionned earlier</a>.</em></p>
<p>You can define the desired sample prevalence when sampling presences
and absences, with the parameter <code>sample.prevalence</code>:</p>
<pre class="r"><code>PA.points &lt;- sampleOccurrences(my.first.species,
                               n = 30,
                               type = &quot;presence-absence&quot;,
                               sample.prevalence = 0.5)</code></pre>
<div class="float">
<img src="07-sampleoccurrences_files/figure-html/samp23-1.png"
alt="Fig 7.17 Presence-absence points sampled with a prevalence of 0.5 (i.e., 50% of presence points, 50% of absence points)" />
<div class="figcaption">Fig 7.17 Presence-absence points sampled with a
prevalence of 0.5 (i.e., 50% of presence points, 50% of absence
points)</div>
</div>
<pre class="r"><code>PA.points</code></pre>
<pre><code>## Occurrence points sampled from a virtual species
## 
## - Type: presence-absence
## - Number of points: 30
## - No sampling bias
## - Detection probability: 
##    .Probability: 1
##    .Corrected by suitability: FALSE
## - Probability of identification error (false positive): 0
## - Sample prevalence: 
##    .True:0.5
##    .Observed:0.5
## - Multiple samples can occur in a single cell: No
## 
## First 10 lines: 
##                 x            y Real Observed
## 1170333 115.41667  -0.25000000    1        1
## 1220119 133.08333  -4.08333333    1        1
## 1391037 179.41667 -17.25000000    1        1
## 1195202 -59.75000  -2.25000000    1        1
## 1189764 113.91667  -1.75000000    1        1
## 1161599  99.75000   0.41666667    1        1
## 1230943 137.08333  -4.91666667    1        1
## 1260058 -50.41667  -7.25000000    1        1
## 1218947 -62.25000  -4.08333333    1        1
## 1165926 100.91667   0.08333333    1        1
## ... 20 more lines.</code></pre>
</div>

<p><br>
<br>
-----------------
<br>


Do not hesitate if you have a question, find a bug, or would like to add a feature in virtualspecies: mail me!</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
